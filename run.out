STARTING AT Mon May 1 16:35:53 CEST 2023
[rank: 0] Global seed set to 42
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/home/mery/venvs/hfi/lib/python3.7/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:613: UserWarning: Checkpoint directory /home/mery/hfi/out/logsTransformerEncoder exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                | Type                        | Params
--------------------------------------------------------------------
0 | criterion           | MaskedMSELoss               | 0     
1 | project_inp         | Linear                      | 5.1 K 
2 | pos_enc             | LearnablePositionalEncoding | 38.4 K
3 | transformer_encoder | TransformerEncoder          | 1.2 M 
4 | output_layer        | Linear                      | 4.9 K 
5 | dropout1            | Dropout                     | 0     
--------------------------------------------------------------------
1.2 M     Trainable params
0         Non-trainable params
1.2 M     Total params
4.943     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Epoch 0, global step 135: 'val_loss' reached 0.37399 (best 0.37399), saving model to '/home/mery/hfi/out/logsTransformerEncoder/best_val_loss-v2.ckpt' as top 1
/home/mery/venvs/hfi/lib/python3.7/site-packages/lightning_fabric/plugins/io/torch_io.py:61: UserWarning: Warning, `hyper_parameters` dropped from checkpoint. An attribute is not picklable: Can't pickle local object 'EvaluationLoop.advance.<locals>.batch_to_device'
  rank_zero_warn(f"Warning, `{key}` dropped from checkpoint. An attribute is not picklable: {err}")
Epoch 1, global step 270: 'val_loss' reached 0.23590 (best 0.23590), saving model to '/home/mery/hfi/out/logsTransformerEncoder/best_val_loss-v2.ckpt' as top 1
Epoch 2, global step 405: 'val_loss' reached 0.20560 (best 0.20560), saving model to '/home/mery/hfi/out/logsTransformerEncoder/best_val_loss-v2.ckpt' as top 1
Epoch 3, global step 540: 'val_loss' reached 0.19075 (best 0.19075), saving model to '/home/mery/hfi/out/logsTransformerEncoder/best_val_loss-v2.ckpt' as top 1
Epoch 4, global step 675: 'val_loss' reached 0.16155 (best 0.16155), saving model to '/home/mery/hfi/out/logsTransformerEncoder/best_val_loss-v2.ckpt' as top 1
Epoch 5, global step 810: 'val_loss' reached 0.15160 (best 0.15160), saving model to '/home/mery/hfi/out/logsTransformerEncoder/best_val_loss-v2.ckpt' as top 1
Epoch 6, global step 945: 'val_loss' reached 0.14007 (best 0.14007), saving model to '/home/mery/hfi/out/logsTransformerEncoder/best_val_loss-v2.ckpt' as top 1
Epoch 7, global step 1080: 'val_loss' reached 0.12854 (best 0.12854), saving model to '/home/mery/hfi/out/logsTransformerEncoder/best_val_loss-v2.ckpt' as top 1
