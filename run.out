STARTING AT Thu May 4 12:53:18 CEST 2023
[rank: 0] Global seed set to 42
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Missing logger folder: out/logsFineTunedTransformerClassifier
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name        | Type                      | Params
----------------------------------------------------------
0 | criterion   | CrossEntropyLoss          | 0     
1 | accuracy    | MulticlassAccuracy        | 0     
2 | f1          | MulticlassF1Score         | 0     
3 | confmat     | MulticlassConfusionMatrix | 0     
4 | encoder     | TransformerEncoder        | 817 K 
5 | global_attn | GlobalTemporalAttention   | 16.6 K
6 | classifier  | Linear                    | 645   
----------------------------------------------------------
834 K     Trainable params
0         Non-trainable params
834 K     Total params
3.338     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
/home/mery/venvs/hfi/lib/python3.7/site-packages/pytorch_lightning/trainer/trainer.py:1613: PossibleUserWarning: The number of training batches (13) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
  category=PossibleUserWarning,
Epoch 0, global step 13: 'f1' reached 0.72211 (best 0.72211), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1.ckpt' as top 1
Epoch 0, global step 13: 'val_loss' reached 0.68648 (best 0.68648), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_val_loss.ckpt' as top 1
Epoch 1, global step 26: 'f1' was not in top 1
Epoch 1, global step 26: 'val_loss' reached 0.67144 (best 0.67144), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_val_loss.ckpt' as top 1
Epoch 2, global step 39: 'f1' reached 0.72604 (best 0.72604), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1.ckpt' as top 1
Epoch 2, global step 39: 'val_loss' was not in top 1
Epoch 3, global step 52: 'f1' reached 0.76579 (best 0.76579), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1.ckpt' as top 1
Epoch 3, global step 52: 'val_loss' was not in top 1
Epoch 4, global step 65: 'f1' was not in top 1
Epoch 4, global step 65: 'val_loss' was not in top 1
Epoch 5, global step 78: 'f1' reached 0.77775 (best 0.77775), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1.ckpt' as top 1
Epoch 5, global step 78: 'val_loss' reached 0.66522 (best 0.66522), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_val_loss.ckpt' as top 1
Epoch 6, global step 91: 'f1' was not in top 1
Epoch 6, global step 91: 'val_loss' was not in top 1
Epoch 7, global step 104: 'f1' was not in top 1
Epoch 7, global step 104: 'val_loss' was not in top 1
Epoch 8, global step 117: 'f1' was not in top 1
Epoch 8, global step 117: 'val_loss' was not in top 1
Epoch 9, global step 130: 'f1' was not in top 1
Epoch 9, global step 130: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_epochs=10` reached.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/home/mery/venvs/hfi/lib/python3.7/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:613: UserWarning: Checkpoint directory /home/mery/hfi/out/logsFineTunedTransformerClassifier exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name        | Type                      | Params
----------------------------------------------------------
0 | criterion   | CrossEntropyLoss          | 0     
1 | accuracy    | MulticlassAccuracy        | 0     
2 | f1          | MulticlassF1Score         | 0     
3 | confmat     | MulticlassConfusionMatrix | 0     
4 | encoder     | TransformerEncoder        | 817 K 
5 | global_attn | GlobalTemporalAttention   | 16.6 K
6 | classifier  | Linear                    | 645   
----------------------------------------------------------
834 K     Trainable params
0         Non-trainable params
834 K     Total params
3.338     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Epoch 0, global step 13: 'f1' reached 0.76678 (best 0.76678), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1-v1.ckpt' as top 1
Epoch 0, global step 13: 'val_loss' reached 0.64504 (best 0.64504), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_val_loss-v1.ckpt' as top 1
Epoch 1, global step 26: 'f1' was not in top 1
Epoch 1, global step 26: 'val_loss' was not in top 1
Epoch 2, global step 39: 'f1' reached 0.80641 (best 0.80641), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1-v1.ckpt' as top 1
Epoch 2, global step 39: 'val_loss' reached 0.58191 (best 0.58191), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_val_loss-v1.ckpt' as top 1
Epoch 3, global step 52: 'f1' was not in top 1
Epoch 3, global step 52: 'val_loss' was not in top 1
Epoch 4, global step 65: 'f1' was not in top 1
Epoch 4, global step 65: 'val_loss' was not in top 1
Epoch 5, global step 78: 'f1' was not in top 1
Epoch 5, global step 78: 'val_loss' was not in top 1
Epoch 6, global step 91: 'f1' was not in top 1
Epoch 6, global step 91: 'val_loss' was not in top 1
Epoch 7, global step 104: 'f1' was not in top 1
Epoch 7, global step 104: 'val_loss' was not in top 1
Epoch 8, global step 117: 'f1' was not in top 1
Epoch 8, global step 117: 'val_loss' was not in top 1
Epoch 9, global step 130: 'f1' was not in top 1
Epoch 9, global step 130: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_epochs=10` reached.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name        | Type                      | Params
----------------------------------------------------------
0 | criterion   | CrossEntropyLoss          | 0     
1 | accuracy    | MulticlassAccuracy        | 0     
2 | f1          | MulticlassF1Score         | 0     
3 | confmat     | MulticlassConfusionMatrix | 0     
4 | encoder     | TransformerEncoder        | 817 K 
5 | global_attn | GlobalTemporalAttention   | 16.6 K
6 | classifier  | Linear                    | 645   
----------------------------------------------------------
834 K     Trainable params
0         Non-trainable params
834 K     Total params
3.338     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Epoch 0, global step 13: 'f1' reached 0.71948 (best 0.71948), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1-v2.ckpt' as top 1
Epoch 0, global step 13: 'val_loss' reached 0.70015 (best 0.70015), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_val_loss-v2.ckpt' as top 1
Epoch 1, global step 26: 'f1' reached 0.73683 (best 0.73683), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1-v2.ckpt' as top 1
Epoch 1, global step 26: 'val_loss' was not in top 1
Epoch 2, global step 39: 'f1' was not in top 1
Epoch 2, global step 39: 'val_loss' was not in top 1
Epoch 3, global step 52: 'f1' was not in top 1
Epoch 3, global step 52: 'val_loss' was not in top 1
Epoch 4, global step 65: 'f1' was not in top 1
Epoch 4, global step 65: 'val_loss' was not in top 1
Epoch 5, global step 78: 'f1' reached 0.74334 (best 0.74334), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1-v2.ckpt' as top 1
Epoch 5, global step 78: 'val_loss' was not in top 1
Epoch 6, global step 91: 'f1' reached 0.77271 (best 0.77271), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1-v2.ckpt' as top 1
Epoch 6, global step 91: 'val_loss' was not in top 1
Epoch 7, global step 104: 'f1' was not in top 1
Epoch 7, global step 104: 'val_loss' was not in top 1
Epoch 8, global step 117: 'f1' was not in top 1
Epoch 8, global step 117: 'val_loss' was not in top 1
Epoch 9, global step 130: 'f1' was not in top 1
Epoch 9, global step 130: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_epochs=10` reached.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name        | Type                      | Params
----------------------------------------------------------
0 | criterion   | CrossEntropyLoss          | 0     
1 | accuracy    | MulticlassAccuracy        | 0     
2 | f1          | MulticlassF1Score         | 0     
3 | confmat     | MulticlassConfusionMatrix | 0     
4 | encoder     | TransformerEncoder        | 817 K 
5 | global_attn | GlobalTemporalAttention   | 16.6 K
6 | classifier  | Linear                    | 645   
----------------------------------------------------------
834 K     Trainable params
0         Non-trainable params
834 K     Total params
3.338     Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Epoch 0, global step 13: 'f1' reached 0.73121 (best 0.73121), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1-v3.ckpt' as top 1
Epoch 0, global step 13: 'val_loss' reached 0.68380 (best 0.68380), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_val_loss-v3.ckpt' as top 1
Epoch 1, global step 26: 'f1' reached 0.76680 (best 0.76680), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1-v3.ckpt' as top 1
Epoch 1, global step 26: 'val_loss' reached 0.64055 (best 0.64055), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_val_loss-v3.ckpt' as top 1
Epoch 2, global step 39: 'f1' reached 0.77979 (best 0.77979), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_f1-v3.ckpt' as top 1
Epoch 2, global step 39: 'val_loss' reached 0.61629 (best 0.61629), saving model to '/home/mery/hfi/out/logsFineTunedTransformerClassifier/best_val_loss-v3.ckpt' as top 1
Epoch 3, global step 52: 'f1' was not in top 1
Epoch 3, global step 52: 'val_loss' was not in top 1
Epoch 4, global step 65: 'f1' was not in top 1
Epoch 4, global step 65: 'val_loss' was not in top 1
Epoch 5, global step 78: 'f1' was not in top 1
Epoch 5, global step 78: 'val_loss' was not in top 1
Epoch 6, global step 91: 'f1' was not in top 1
Epoch 6, global step 91: 'val_loss' was not in top 1
Epoch 7, global step 104: 'f1' was not in top 1
Epoch 7, global step 104: 'val_loss' was not in top 1
Epoch 8, global step 117: 'f1' was not in top 1
Epoch 8, global step 117: 'val_loss' was not in top 1
Epoch 9, global step 130: 'f1' was not in top 1
Epoch 9, global step 130: 'val_loss' was not in top 1
`Trainer.fit` stopped: `max_epochs=10` reached.
FINISHED at Thu May 4 12:55:53 CEST 2023
